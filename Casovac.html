<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <title>Časovač</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      body {
        text-align: center;
        align-content: center;
        justify-content: center;
      }

      .theEnd
      {
        color: red;
      }
    </style>
  </head>
  <body>
    <h1>Časovač</h1>

    <h1 id="cas" hidden="hidden">Zde bude čas</h1>
    <hr>

    <div>
      <div>
        <label for="timeHours">
          Počet hodin
        </label>
      </div>
      <div>
        <input type="number" max="24" min="0" value="0" id="timeHours"/>
      </div>
      <div>
        <label for="timeMinutes">
          Počet minut
        </label>
      </div>
      <div>
        <input type="number" max="60" min="0" value="0" id="timeMinutes"/>
      </div>
      <div>
        <label for="timeSeconds">
          Počet sekund
        </label>
      </div>
      <div>
        <input type="number" max="60" min="0" value="0" id="timeSeconds"/>
      </div>
      <div>
        <input type="button" value="Zadat čas" onclick="setTime()">
      </div>
    </div>
  </body>
  <!--suppress ES6ConvertVarToLetConst -->
  <script type="text/javascript">
      const timeLabel = document.getElementById('cas');

      var totalSecondsLeft;
      var intervalId;
      function setTime()
      {
        clearInterval(intervalId);

        const timeHours = parseInt(document.getElementById('timeHours').value);
        const timeMinutes = parseInt(document.getElementById('timeMinutes').value);
        const timeSeconds = parseInt(document.getElementById('timeSeconds').value);

        const totalSeconds = (timeHours * 3600) + (timeMinutes * 60) + timeSeconds;

        if (totalSeconds === 0)
        {
          alert('Proč?!');
          return;
        }

        totalSecondsLeft = totalSeconds;
        intervalId = setInterval(processTime, 1000);

        timeLabel.removeAttribute('class');
        timeLabel.removeAttribute('hidden');
      }

      function sklonovani(number)
      {
        if (number === 1) {
          return 'a';
        }

        if (number === 2 || number === 3 || number === 4) {
          return 'y';
        }

        return '';
      }

      function processTime()
      {
        if (--totalSecondsLeft === 0) {
          const audio = new Audio('sound.mp3')
          audio.loop = false;
          audio.play();

          timeLabel.setAttribute('class', 'theEnd');
          timeLabel.innerText = 'Čas vypršel!';
          clearInterval(intervalId);

          return;
        }

        const totalMinutesLeft = Math.trunc(totalSecondsLeft / 60);
        const secondsLeft = totalSecondsLeft - (totalMinutesLeft * 60);
        const hoursLeft = Math.trunc(totalMinutesLeft / 60);
        const minutesLeft = totalMinutesLeft - (hoursLeft * 60);

        timeLabel.innerText = `${hoursLeft} hodin${sklonovani(hoursLeft)} ${minutesLeft} minut${sklonovani(minutesLeft)} ${secondsLeft} sekund${sklonovani(secondsLeft)}`;
      }
  </script>
</html>
